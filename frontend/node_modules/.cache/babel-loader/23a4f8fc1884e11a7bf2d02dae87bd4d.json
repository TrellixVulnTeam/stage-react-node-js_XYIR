{"ast":null,"code":"var _jsxFileName = \"/Users/yasmine/Desktop/stage/aidchannel-front/src/components/linkedin/feed/Feed.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect, useCallback } from \"react\";\nimport Modal from \"react-modal\";\nimport InputOption from \"../inputOption/InputOption\";\nimport Post from \"../post/Post\";\nimport ImageIcon from \"@material-ui/icons/Image\";\nimport SubscriptionsIcon from \"@material-ui/icons/Subscriptions\";\nimport EventNoteIcon from \"@material-ui/icons/EventNote\";\nimport CalendarViewDayIcon from \"@material-ui/icons/CalendarViewDay\";\nimport FlipMove from \"react-flip-move\";\nimport \"./Feed.css\";\nimport HeaderOption from \"../header/HeaderOption\";\nimport urlImageAdapter from \"helpers/urlImageAdapter\";\nimport { addLikeToPostApi, deleteLikeFromPostApi, getPostsApi } from \"apis/postApi\";\nimport PostModal from \"../postModal/PostModal\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nModal.setAppElement(\"#root\");\n\nfunction Feed() {\n  _s();\n\n  const [modalIsOpen, setIsModalOpen] = useState(false);\n  const [posts, setPosts] = useState([]);\n  const [disableLikeButton, setDisableLikeButton] = useState({\n    postId: null,\n    disabled: false\n  });\n  const userInfo = JSON.parse(localStorage.getItem(\"userInfo\"));\n  const getDataFromApi = useCallback(async () => {\n    const posts = await getPostsApi();\n    setPosts(posts);\n  }, []);\n  useEffect(() => {\n    getDataFromApi();\n  }, [getDataFromApi]);\n\n  const onLike = async post => {\n    setDisableLikeButton({\n      postId: post._id,\n      disabled: true\n    });\n\n    if (isIncludeUserId(post === null || post === void 0 ? void 0 : post.likes).isExist) {\n      console.log(\"debut\");\n      await deleteLikeFromPostApi(isIncludeUserId(post === null || post === void 0 ? void 0 : post.likes).likeId, post === null || post === void 0 ? void 0 : post._id);\n      const newPosts = posts.map(mapPost => {\n        console.log(\"map\");\n\n        if ((mapPost === null || mapPost === void 0 ? void 0 : mapPost._id) == (post === null || post === void 0 ? void 0 : post._id)) {\n          var _mapPost$likes;\n\n          console.log(\"if\");\n          const filtredLikes = mapPost === null || mapPost === void 0 ? void 0 : (_mapPost$likes = mapPost.likes) === null || _mapPost$likes === void 0 ? void 0 : _mapPost$likes.filter(like => {\n            if ((like === null || like === void 0 ? void 0 : like._id) == isIncludeUserId(post === null || post === void 0 ? void 0 : post.likes).likeId) return false;\n            return true;\n          });\n          return { ...mapPost,\n            likes: filtredLikes\n          };\n        }\n\n        return mapPost;\n      });\n      setPosts(newPosts);\n    } else {\n      var _userInfo$user;\n\n      const newLike = await addLikeToPostApi(userInfo === null || userInfo === void 0 ? void 0 : (_userInfo$user = userInfo.user) === null || _userInfo$user === void 0 ? void 0 : _userInfo$user._id, post === null || post === void 0 ? void 0 : post._id);\n      const newPosts = posts.map(mapPost => {\n        if ((mapPost === null || mapPost === void 0 ? void 0 : mapPost._id) == (post === null || post === void 0 ? void 0 : post._id)) return { ...mapPost,\n          likes: [...mapPost.likes, newLike]\n        };\n        return mapPost;\n      });\n      setPosts(newPosts);\n    }\n\n    setDisableLikeButton({\n      postId: null,\n      disabled: false\n    });\n  };\n\n  const isIncludeUserId = likes => {\n    const like = likes.filter(like => {\n      if (like.userId == userInfo.user._id) return true;\n      return false;\n    });\n    if (like.length > 0) return {\n      isExist: true,\n      likeId: like[0]._id\n    };\n    return {\n      isExist: false,\n      likeId: null\n    };\n  };\n\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"feed\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"feed__inputContainer\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"feed__input\",\n          children: [/*#__PURE__*/_jsxDEV(HeaderOption, {\n            avatar: true,\n            title: \"\",\n            onClick: () => {}\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 95,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n            onClick: () => setIsModalOpen(true),\n            children: /*#__PURE__*/_jsxDEV(\"input\", {\n              disabled: true,\n              placeholder: \"Start a post\" // onChange={(e) => setInput(e.target.value)}\n              ,\n              type: \"text\",\n              className: \"input__post__disabled\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 97,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 96,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 94,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"feed__inputOptions\",\n          children: [/*#__PURE__*/_jsxDEV(InputOption, {\n            Icon: ImageIcon,\n            title: \"Photo\",\n            color: \"#70B5F9\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 108,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(InputOption, {\n            Icon: SubscriptionsIcon,\n            title: \"Video\",\n            color: \"#E7A33E\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 109,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(InputOption, {\n            Icon: EventNoteIcon,\n            title: \"Event\",\n            color: \"#C0CBCD\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 114,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(InputOption, {\n            Icon: CalendarViewDayIcon,\n            title: \"Write\",\n            color: \"#7FC15E\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 115,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 107,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 93,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(FlipMove, {\n        children: posts === null || posts === void 0 ? void 0 : posts.map((post, index) => {\n          var _post$user, _post$user2, _post$user3;\n\n          return /*#__PURE__*/_jsxDEV(Post, {\n            name: post === null || post === void 0 ? void 0 : (_post$user = post.user) === null || _post$user === void 0 ? void 0 : _post$user.fullname,\n            description: post === null || post === void 0 ? void 0 : (_post$user2 = post.user) === null || _post$user2 === void 0 ? void 0 : _post$user2.job_title,\n            message: post === null || post === void 0 ? void 0 : post.content,\n            photoUrl: urlImageAdapter(post === null || post === void 0 ? void 0 : (_post$user3 = post.user) === null || _post$user3 === void 0 ? void 0 : _post$user3.image_url),\n            postImage: post.image ? urlImageAdapter(post === null || post === void 0 ? void 0 : post.image) : undefined,\n            createdAt: post === null || post === void 0 ? void 0 : post.createdAt,\n            onLike: () => onLike(post),\n            isLike: isIncludeUserId(post === null || post === void 0 ? void 0 : post.likes).isExist,\n            likes: post === null || post === void 0 ? void 0 : post.likes,\n            disableLike: (disableLikeButton === null || disableLikeButton === void 0 ? void 0 : disableLikeButton.disabled) == true && (post === null || post === void 0 ? void 0 : post._id) == (disableLikeButton === null || disableLikeButton === void 0 ? void 0 : disableLikeButton.postId) ? true : false\n          }, index, false, {\n            fileName: _jsxFileName,\n            lineNumber: 124,\n            columnNumber: 13\n          }, this);\n        })\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 122,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 92,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(PostModal, {\n      modalIsOpen: modalIsOpen,\n      setIsModalOpen: setIsModalOpen,\n      posts: posts,\n      setPosts: setPosts\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 145,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true);\n}\n\n_s(Feed, \"VufKKDIsMhSUZz3pcCqey+61JS8=\");\n\n_c = Feed;\nexport default Feed;\n\nvar _c;\n\n$RefreshReg$(_c, \"Feed\");","map":{"version":3,"sources":["/Users/yasmine/Desktop/stage/aidchannel-front/src/components/linkedin/feed/Feed.js"],"names":["React","useState","useEffect","useCallback","Modal","InputOption","Post","ImageIcon","SubscriptionsIcon","EventNoteIcon","CalendarViewDayIcon","FlipMove","HeaderOption","urlImageAdapter","addLikeToPostApi","deleteLikeFromPostApi","getPostsApi","PostModal","setAppElement","Feed","modalIsOpen","setIsModalOpen","posts","setPosts","disableLikeButton","setDisableLikeButton","postId","disabled","userInfo","JSON","parse","localStorage","getItem","getDataFromApi","onLike","post","_id","isIncludeUserId","likes","isExist","console","log","likeId","newPosts","map","mapPost","filtredLikes","filter","like","newLike","user","userId","length","index","fullname","job_title","content","image_url","image","undefined","createdAt"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, useCallback } from \"react\";\nimport Modal from \"react-modal\";\nimport InputOption from \"../inputOption/InputOption\";\nimport Post from \"../post/Post\";\nimport ImageIcon from \"@material-ui/icons/Image\";\nimport SubscriptionsIcon from \"@material-ui/icons/Subscriptions\";\nimport EventNoteIcon from \"@material-ui/icons/EventNote\";\nimport CalendarViewDayIcon from \"@material-ui/icons/CalendarViewDay\";\nimport FlipMove from \"react-flip-move\";\nimport \"./Feed.css\";\nimport HeaderOption from \"../header/HeaderOption\";\nimport urlImageAdapter from \"helpers/urlImageAdapter\";\nimport {\n  addLikeToPostApi,\n  deleteLikeFromPostApi,\n  getPostsApi,\n} from \"apis/postApi\";\nimport PostModal from \"../postModal/PostModal\";\n\nModal.setAppElement(\"#root\");\n\nfunction Feed() {\n  const [modalIsOpen, setIsModalOpen] = useState(false);\n  const [posts, setPosts] = useState([]);\n  const [disableLikeButton, setDisableLikeButton] = useState({\n    postId: null,\n    disabled: false,\n  });\n  const userInfo = JSON.parse(localStorage.getItem(\"userInfo\"));\n\n  const getDataFromApi = useCallback(async () => {\n    const posts = await getPostsApi();\n    setPosts(posts);\n  }, []);\n\n  useEffect(() => {\n    getDataFromApi();\n  }, [getDataFromApi]);\n\n  const onLike = async (post) => {\n    setDisableLikeButton({\n      postId: post._id,\n      disabled: true,\n    });\n    if (isIncludeUserId(post?.likes).isExist) {\n      console.log(\"debut\");\n      await deleteLikeFromPostApi(\n        isIncludeUserId(post?.likes).likeId,\n        post?._id\n      );\n      const newPosts = posts.map((mapPost) => {\n        console.log(\"map\");\n        if (mapPost?._id == post?._id) {\n          console.log(\"if\");\n          const filtredLikes = mapPost?.likes?.filter((like) => {\n            if (like?._id == isIncludeUserId(post?.likes).likeId) return false;\n            return true;\n          });\n\n          return { ...mapPost, likes: filtredLikes };\n        }\n        return mapPost;\n      });\n\n      setPosts(newPosts);\n    } else {\n      const newLike = await addLikeToPostApi(userInfo?.user?._id, post?._id);\n      const newPosts = posts.map((mapPost) => {\n        if (mapPost?._id == post?._id)\n          return { ...mapPost, likes: [...mapPost.likes, newLike] };\n        return mapPost;\n      });\n      setPosts(newPosts);\n    }\n    setDisableLikeButton({\n      postId: null,\n      disabled: false,\n    });\n  };\n\n  const isIncludeUserId = (likes) => {\n    const like = likes.filter((like) => {\n      if (like.userId == userInfo.user._id) return true;\n      return false;\n    });\n    if (like.length > 0) return { isExist: true, likeId: like[0]._id };\n    return { isExist: false, likeId: null };\n  };\n\n  return (\n    <>\n      <div className=\"feed\">\n        <div className=\"feed__inputContainer\">\n          <div className=\"feed__input\">\n            <HeaderOption avatar={true} title=\"\" onClick={() => {}} />\n            <form onClick={() => setIsModalOpen(true)}>\n              <input\n                disabled\n                placeholder=\"Start a post\"\n                // onChange={(e) => setInput(e.target.value)}\n                type=\"text\"\n                className=\"input__post__disabled\"\n              />\n            </form>\n          </div>\n\n          <div className=\"feed__inputOptions\">\n            <InputOption Icon={ImageIcon} title=\"Photo\" color=\"#70B5F9\" />\n            <InputOption\n              Icon={SubscriptionsIcon}\n              title=\"Video\"\n              color=\"#E7A33E\"\n            />\n            <InputOption Icon={EventNoteIcon} title=\"Event\" color=\"#C0CBCD\" />\n            <InputOption\n              Icon={CalendarViewDayIcon}\n              title=\"Write\"\n              color=\"#7FC15E\"\n            />\n          </div>\n        </div>\n        <FlipMove>\n          {posts?.map((post, index) => (\n            <Post\n              key={index}\n              name={post?.user?.fullname}\n              description={post?.user?.job_title}\n              message={post?.content}\n              photoUrl={urlImageAdapter(post?.user?.image_url)}\n              postImage={post.image ? urlImageAdapter(post?.image) : undefined}\n              createdAt={post?.createdAt}\n              onLike={() => onLike(post)}\n              isLike={isIncludeUserId(post?.likes).isExist}\n              likes={post?.likes}\n              disableLike={\n                disableLikeButton?.disabled == true &&\n                post?._id == disableLikeButton?.postId\n                  ? true\n                  : false\n              }\n            />\n          ))}\n        </FlipMove>\n      </div>\n      <PostModal\n        modalIsOpen={modalIsOpen}\n        setIsModalOpen={setIsModalOpen}\n        posts={posts}\n        setPosts={setPosts}\n      />\n    </>\n  );\n}\n\nexport default Feed;\n"]},"metadata":{},"sourceType":"module"}