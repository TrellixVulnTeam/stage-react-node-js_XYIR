{"ast":null,"code":"var _jsxFileName = \"/Users/yasmine/Desktop/stage/aidchannel-front/src/components/linkedin/post/Post.js\",\n    _s = $RefreshSig$();\n\nimport React, { forwardRef, useState, useCallback, useEffect, useRef } from \"react\";\nimport { useHistory } from \"react-router-dom\";\nimport { Avatar } from \"@material-ui/core\";\nimport moment from \"moment\";\nimport { useInfiniteQuery } from \"react-query\";\nimport TextareaAutosize from \"react-textarea-autosize\";\nimport ThumbUpAltOutlinedIcon from \"@material-ui/icons/ThumbUpAltOutlined\";\nimport ChatOutlinedIcon from \"@material-ui/icons/ChatOutlined\";\nimport ShareOutlinedIcon from \"@material-ui/icons/ShareOutlined\";\nimport SendOutlinedIcon from \"@material-ui/icons/SendOutlined\";\nimport InputOption from \"../inputOption/InputOption\";\nimport \"./Post.css\";\nimport urlImageAdapter from \"helpers/urlImageAdapter\";\nimport Comment from \"../comment/Comment\";\nimport { addCommentApi, getCommentsApi, getNumberCommentsApi } from \"apis/commentApi\";\nimport useIntersectionObserver from \"helpers/useIntersectionObserver\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst Post = /*#__PURE__*/forwardRef(_c = _s(({\n  name,\n  description,\n  message,\n  photoUrl,\n  isLike,\n  createdAt,\n  likes,\n  onLike,\n  disableLike,\n  postImage,\n  userId,\n  postId\n}, ref) => {\n  var _userInfo$user2;\n\n  _s();\n\n  const history = useHistory();\n  const [commentInput, setCommentInput] = useState(\"\");\n  const userInfo = JSON.parse(localStorage.getItem(\"userInfo\"));\n  const [numberComments, setNumberComments] = useState(0);\n  const [limit] = useState(2);\n  const [refreh, setRefresh] = useState(false);\n  const loadMoreButtonRef = useRef();\n  const getDataFromApi = useCallback(async () => {\n    const numberComments = await getNumberCommentsApi(postId);\n    setNumberComments(numberComments);\n  }, []);\n  useEffect(() => {\n    getDataFromApi();\n  }, [getDataFromApi, refreh]);\n  const {\n    data,\n    fetchNextPage,\n    isFetching,\n    hasNextPage,\n    isFetchingNextPage\n  } = useInfiniteQuery([limit, postId, refreh], getCommentsApi, {\n    getNextPageParam: (lastPage, pages) => {\n      if (lastPage.data.length === limit) return parseInt(lastPage.page) + 1;\n      return false;\n    }\n  });\n  useIntersectionObserver({\n    target: loadMoreButtonRef,\n    onIntersect: fetchNextPage,\n    enabled: hasNextPage\n  });\n\n  const onPostComment = async () => {\n    var _userInfo$user;\n\n    const comment = {\n      content: commentInput,\n      post: postId,\n      user: userInfo === null || userInfo === void 0 ? void 0 : (_userInfo$user = userInfo.user) === null || _userInfo$user === void 0 ? void 0 : _userInfo$user._id,\n      parent_id: null\n    };\n    const newComment = await addCommentApi(comment);\n    setRefresh(!refreh);\n    setCommentInput(\"\");\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    ref: ref,\n    className: \"post border\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"post__header\",\n      children: [/*#__PURE__*/_jsxDEV(Avatar, {\n        src: photoUrl,\n        children: name[0]\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 95,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"post__info\",\n        children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n          onClick: () => history.push(`/linkedin/profil/${userId}`),\n          children: name\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 97,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"m-0\",\n          children: description\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 100,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"m-0\",\n          children: moment(createdAt).startOf(\"minute\").fromNow()\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 101,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 96,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 94,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"post__body\",\n      children: [/*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"comment_message\",\n        children: message\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 109,\n        columnNumber: 11\n      }, this), postImage && /*#__PURE__*/_jsxDEV(\"img\", {\n        src: postImage,\n        width: \"100%\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 110,\n        columnNumber: 25\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 108,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"ml-3 mt-2\",\n      style: {\n        color: \"gray\",\n        fontSize: \"13px\"\n      },\n      children: [/*#__PURE__*/_jsxDEV(ThumbUpAltOutlinedIcon, {\n        className: \"mb-1\",\n        style: {\n          color: \"#0e76a8\",\n          width: \"15px\"\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 113,\n        columnNumber: 11\n      }, this), \" \", likes.length, /*#__PURE__*/_jsxDEV(\"span\", {\n        className: \"ml-3\",\n        children: [numberComments, \" comments\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 118,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 112,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"post__buttons\",\n      children: [/*#__PURE__*/_jsxDEV(InputOption, {\n        Icon: ThumbUpAltOutlinedIcon,\n        title: \"Like\",\n        color: isLike ? \"#0e76a8\" : \"gray\",\n        onLike: onLike,\n        disableLike: disableLike\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 121,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(InputOption, {\n        Icon: ChatOutlinedIcon,\n        title: \"Comment\",\n        color: \"gray\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 128,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(InputOption, {\n        Icon: ShareOutlinedIcon,\n        title: \"Share\",\n        color: \"gray\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 129,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(InputOption, {\n        Icon: SendOutlinedIcon,\n        title: \"Send\",\n        color: \"gray\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 130,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 120,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"comment_input row\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"col-1\",\n        children: /*#__PURE__*/_jsxDEV(Avatar, {\n          className: \"comment_avatar mt-2\",\n          src: urlImageAdapter(userInfo === null || userInfo === void 0 ? void 0 : (_userInfo$user2 = userInfo.user) === null || _userInfo$user2 === void 0 ? void 0 : _userInfo$user2.image_url)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 134,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 133,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"comment__inputContainer col-11\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"comment__input\",\n          children: /*#__PURE__*/_jsxDEV(\"form\", {\n            onClick: () => {},\n            children: /*#__PURE__*/_jsxDEV(TextareaAutosize, {\n              className: \"textarea\",\n              placeholder: \"Add a comment ...\",\n              value: commentInput,\n              onChange: e => setCommentInput(e.target.value)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 143,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 142,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 141,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 140,\n        columnNumber: 11\n      }, this), commentInput !== \"\" && /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: onPostComment,\n        class: \"comment_post_btn btn btn-primary ml-3 shadow-none\",\n        children: \"Post\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 153,\n        columnNumber: 13\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 132,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"comments mt-3\",\n      children: [data === null || data === void 0 ? void 0 : data.pages.map((group, i) => /*#__PURE__*/_jsxDEV(React.Fragment, {\n        children: group.data.map((comment, index) => /*#__PURE__*/_jsxDEV(Comment, {\n          user: comment === null || comment === void 0 ? void 0 : comment.user,\n          content: comment === null || comment === void 0 ? void 0 : comment.content\n        }, index, false, {\n          fileName: _jsxFileName,\n          lineNumber: 165,\n          columnNumber: 17\n        }, this))\n      }, i, false, {\n        fileName: _jsxFileName,\n        lineNumber: 163,\n        columnNumber: 13\n      }, this)), /*#__PURE__*/_jsxDEV(\"div\", {\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"load_comments ml-2\",\n          onClick: () => fetchNextPage(),\n          disabled: !hasNextPage || isFetchingNextPage,\n          children: isFetchingNextPage ? \"Loading more...\" : hasNextPage && \"Load more comments\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 174,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 173,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 161,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 93,\n    columnNumber: 7\n  }, this);\n}, \"XhlGOPuS5w+uuPgec2hQxZdMhxM=\", false, function () {\n  return [useHistory, useInfiniteQuery, useIntersectionObserver];\n}));\n_c2 = Post;\nexport default Post;\n\nvar _c, _c2;\n\n$RefreshReg$(_c, \"Post$forwardRef\");\n$RefreshReg$(_c2, \"Post\");","map":{"version":3,"sources":["/Users/yasmine/Desktop/stage/aidchannel-front/src/components/linkedin/post/Post.js"],"names":["React","forwardRef","useState","useCallback","useEffect","useRef","useHistory","Avatar","moment","useInfiniteQuery","TextareaAutosize","ThumbUpAltOutlinedIcon","ChatOutlinedIcon","ShareOutlinedIcon","SendOutlinedIcon","InputOption","urlImageAdapter","Comment","addCommentApi","getCommentsApi","getNumberCommentsApi","useIntersectionObserver","Post","name","description","message","photoUrl","isLike","createdAt","likes","onLike","disableLike","postImage","userId","postId","ref","history","commentInput","setCommentInput","userInfo","JSON","parse","localStorage","getItem","numberComments","setNumberComments","limit","refreh","setRefresh","loadMoreButtonRef","getDataFromApi","data","fetchNextPage","isFetching","hasNextPage","isFetchingNextPage","getNextPageParam","lastPage","pages","length","parseInt","page","target","onIntersect","enabled","onPostComment","comment","content","post","user","_id","parent_id","newComment","push","startOf","fromNow","color","fontSize","width","image_url","e","value","map","group","i","index"],"mappings":"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","sourcesContent":["import React, {\n  forwardRef,\n  useState,\n  useCallback,\n  useEffect,\n  useRef,\n} from \"react\";\nimport { useHistory } from \"react-router-dom\";\nimport { Avatar } from \"@material-ui/core\";\nimport moment from \"moment\";\nimport { useInfiniteQuery } from \"react-query\";\nimport TextareaAutosize from \"react-textarea-autosize\";\nimport ThumbUpAltOutlinedIcon from \"@material-ui/icons/ThumbUpAltOutlined\";\nimport ChatOutlinedIcon from \"@material-ui/icons/ChatOutlined\";\nimport ShareOutlinedIcon from \"@material-ui/icons/ShareOutlined\";\nimport SendOutlinedIcon from \"@material-ui/icons/SendOutlined\";\nimport InputOption from \"../inputOption/InputOption\";\nimport \"./Post.css\";\nimport urlImageAdapter from \"helpers/urlImageAdapter\";\nimport Comment from \"../comment/Comment\";\nimport {\n  addCommentApi,\n  getCommentsApi,\n  getNumberCommentsApi,\n} from \"apis/commentApi\";\nimport useIntersectionObserver from \"helpers/useIntersectionObserver\";\n\nconst Post = forwardRef(\n  (\n    {\n      name,\n      description,\n      message,\n      photoUrl,\n      isLike,\n      createdAt,\n      likes,\n      onLike,\n      disableLike,\n      postImage,\n      userId,\n      postId,\n    },\n    ref\n  ) => {\n    const history = useHistory();\n    const [commentInput, setCommentInput] = useState(\"\");\n    const userInfo = JSON.parse(localStorage.getItem(\"userInfo\"));\n    const [numberComments, setNumberComments] = useState(0);\n    const [limit] = useState(2);\n    const [refreh, setRefresh] = useState(false);\n    const loadMoreButtonRef = useRef();\n\n    const getDataFromApi = useCallback(async () => {\n      const numberComments = await getNumberCommentsApi(postId);\n      setNumberComments(numberComments);\n    }, []);\n\n    useEffect(() => {\n      getDataFromApi();\n    }, [getDataFromApi, refreh]);\n\n    const {\n      data,\n      fetchNextPage,\n      isFetching,\n      hasNextPage,\n      isFetchingNextPage,\n    } = useInfiniteQuery([limit, postId, refreh], getCommentsApi, {\n      getNextPageParam: (lastPage, pages) => {\n        if (lastPage.data.length === limit) return parseInt(lastPage.page) + 1;\n        return false;\n      },\n    });\n    useIntersectionObserver({\n      target: loadMoreButtonRef,\n      onIntersect: fetchNextPage,\n      enabled: hasNextPage,\n    });\n\n    const onPostComment = async () => {\n      const comment = {\n        content: commentInput,\n        post: postId,\n        user: userInfo?.user?._id,\n        parent_id: null,\n      };\n      const newComment = await addCommentApi(comment);\n      setRefresh(!refreh);\n      setCommentInput(\"\");\n    };\n    return (\n      <div ref={ref} className=\"post border\">\n        <div className=\"post__header\">\n          <Avatar src={photoUrl}>{name[0]}</Avatar>\n          <div className=\"post__info\">\n            <h2 onClick={() => history.push(`/linkedin/profil/${userId}`)}>\n              {name}\n            </h2>\n            <p className=\"m-0\">{description}</p>\n            <p className=\"m-0\">\n              {moment(createdAt)\n                .startOf(\"minute\")\n                .fromNow()}\n            </p>\n          </div>\n        </div>\n        <div className=\"post__body\">\n          <p className=\"comment_message\">{message}</p>\n          {postImage && <img src={postImage} width=\"100%\" />}\n        </div>\n        <div className=\"ml-3 mt-2\" style={{ color: \"gray\", fontSize: \"13px\" }}>\n          <ThumbUpAltOutlinedIcon\n            className=\"mb-1\"\n            style={{ color: \"#0e76a8\", width: \"15px\" }}\n          />{\" \"}\n          {likes.length}\n          <span className=\"ml-3\">{numberComments} comments</span>\n        </div>\n        <div className=\"post__buttons\">\n          <InputOption\n            Icon={ThumbUpAltOutlinedIcon}\n            title=\"Like\"\n            color={isLike ? \"#0e76a8\" : \"gray\"}\n            onLike={onLike}\n            disableLike={disableLike}\n          />\n          <InputOption Icon={ChatOutlinedIcon} title=\"Comment\" color=\"gray\" />\n          <InputOption Icon={ShareOutlinedIcon} title=\"Share\" color=\"gray\" />\n          <InputOption Icon={SendOutlinedIcon} title=\"Send\" color=\"gray\" />\n        </div>\n        <div className=\"comment_input row\">\n          <div className=\"col-1\">\n            <Avatar\n              className=\"comment_avatar mt-2\"\n              src={urlImageAdapter(userInfo?.user?.image_url)}\n            ></Avatar>\n          </div>\n\n          <div className=\"comment__inputContainer col-11\">\n            <div className=\"comment__input\">\n              <form onClick={() => {}}>\n                <TextareaAutosize\n                  className=\"textarea\"\n                  placeholder=\"Add a comment ...\"\n                  value={commentInput}\n                  onChange={(e) => setCommentInput(e.target.value)}\n                />\n              </form>\n            </div>\n          </div>\n          {commentInput !== \"\" && (\n            <button\n              onClick={onPostComment}\n              class=\"comment_post_btn btn btn-primary ml-3 shadow-none\"\n            >\n              Post\n            </button>\n          )}\n        </div>\n        <div className=\"comments mt-3\">\n          {data?.pages.map((group, i) => (\n            <React.Fragment key={i}>\n              {group.data.map((comment, index) => (\n                <Comment\n                  key={index}\n                  user={comment?.user}\n                  content={comment?.content}\n                />\n              ))}\n            </React.Fragment>\n          ))}\n          <div>\n            <div\n              className=\"load_comments ml-2\"\n              onClick={() => fetchNextPage()}\n              disabled={!hasNextPage || isFetchingNextPage}\n            >\n              {isFetchingNextPage\n                ? \"Loading more...\"\n                : hasNextPage && \"Load more comments\"}\n            </div>\n          </div>\n        </div>\n      </div>\n    );\n  }\n);\n\nexport default Post;\n"]},"metadata":{},"sourceType":"module"}