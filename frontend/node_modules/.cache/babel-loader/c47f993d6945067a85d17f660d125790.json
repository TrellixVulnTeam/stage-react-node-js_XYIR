{"ast":null,"code":"var _jsxFileName = \"/Users/yasmine/Desktop/stage/aidchannel-front/src/components/aidchannel/superadmin/OrganizationForm.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useRef, useEffect, useCallback } from \"react\";\nimport { useHistory, useParams } from \"react-router-dom\";\nimport { useForm } from \"react-hook-form\";\nimport JoditEditor from \"jodit-react\";\nimport Select from \"react-select\";\nimport { getCountryByCode } from \"../../../apis/countryApi\";\nimport { AddOrganization, getAllHeadOrganizationsWithIdAndName, getOrganization, updateOrganization } from \"../../../apis/organizationApi\";\nimport \"../webmaster/OrganizationForm.css\";\nimport fakeLogo from \"../../../assets/images/fakeLogo.png\";\nimport urlImageAdapter from \"helpers/urlImageAdapter\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst AddOrganizationForm = () => {\n  _s();\n\n  const history = useHistory();\n  const {\n    codeCountry,\n    idSubOrganization\n  } = useParams();\n  const editor = useRef(null);\n  const [content, setContent] = useState(\"\");\n  const [options, setOptions] = useState();\n  const [selectedOption, setSelectedOption] = useState(null);\n  const [suborganization, setSubOrganization] = useState();\n  const [isResResData, setIsResData] = useState(false);\n  const [logoPreview, setLogoPreview] = useState(null);\n  const [logo, setLogo] = useState();\n  const config = {\n    readonly: false,\n    placeholder: \"Write Organization description\"\n  };\n  const {\n    register,\n    handleSubmit,\n    setValue //formState: { errors },\n\n  } = useForm();\n  const getDataFromApi = useCallback(async () => {\n    const organizations = await getAllHeadOrganizationsWithIdAndName();\n    setOptions(organizations === null || organizations === void 0 ? void 0 : organizations.map(org => {\n      return {\n        value: org._id,\n        label: org.name\n      };\n    }));\n\n    if (idSubOrganization !== undefined) {\n      var _subOrg$head_office_i, _subOrg$head_office_i2;\n\n      const subOrg = await getOrganization(idSubOrganization);\n      setSubOrganization(subOrg);\n      setLogoPreview(suborganization === null || suborganization === void 0 ? void 0 : suborganization.logo);\n      setSelectedOption({\n        value: subOrg === null || subOrg === void 0 ? void 0 : (_subOrg$head_office_i = subOrg.head_office_id) === null || _subOrg$head_office_i === void 0 ? void 0 : _subOrg$head_office_i._id,\n        label: subOrg === null || subOrg === void 0 ? void 0 : (_subOrg$head_office_i2 = subOrg.head_office_id) === null || _subOrg$head_office_i2 === void 0 ? void 0 : _subOrg$head_office_i2.name\n      });\n      setContent(subOrg === null || subOrg === void 0 ? void 0 : subOrg.description);\n      setValue(\"name\", subOrg === null || subOrg === void 0 ? void 0 : subOrg.name);\n      setValue(\"organization_size\", subOrg === null || subOrg === void 0 ? void 0 : subOrg.organization_size);\n      setValue(\"youtube_url\", subOrg === null || subOrg === void 0 ? void 0 : subOrg.youtube_url);\n\n      if (subOrg.twitter_username) {\n        setValue(\"twitter_username\", `https://twitter.com/${subOrg === null || subOrg === void 0 ? void 0 : subOrg.twitter_username}`);\n      }\n    } else {\n      setLogoPreview(fakeLogo);\n    }\n\n    setIsResData(true);\n  }, [idSubOrganization, setValue, isResResData]);\n  useEffect(() => {\n    getDataFromApi();\n  }, [getDataFromApi]);\n\n  const onSubmit = async data => {\n    var _data$twitter_usernam;\n\n    const country = await getCountryByCode(codeCountry);\n    const headOffice = await getOrganization(selectedOption === null || selectedOption === void 0 ? void 0 : selectedOption.value);\n    let formData = new FormData();\n    formData.append(\"head_office_id\", headOffice === null || headOffice === void 0 ? void 0 : headOffice._id);\n    formData.append(\"organization_types\", JSON.stringify(headOffice === null || headOffice === void 0 ? void 0 : headOffice.organization_types));\n    if (data.twitter_username === \"\") formData.append(\"twitter_username\", null);else formData.append(\"twitter_username\", data === null || data === void 0 ? void 0 : (_data$twitter_usernam = data.twitter_username) === null || _data$twitter_usernam === void 0 ? void 0 : _data$twitter_usernam.substring(20));\n    if (data.youtube_url === \"\") formData.append(\"youtube_url\", null);else formData.append(\"youtube_url\", data.youtube_url);\n    if (data.organization_size === \"\") formData.append(\"organization_size\", null);else formData.append(\"organization_size\", data.organization_size);\n    if (content === \"\") formData.append(\"description\", null);else formData.append(\"description\", content);\n    if (logo != undefined) formData.append(\"logoOrg\", logo);\n    formData.append(\"name\", data.name);\n    formData.append(\"country\", country._id);\n    console.log(formData);\n\n    if (idSubOrganization !== undefined) {\n      await updateOrganization(idSubOrganization, formData);\n    } else {\n      await AddOrganization(formData);\n    }\n\n    history.push(`/web-master/organizations/${codeCountry}`);\n  };\n\n  const handleChange = selectedOption => {\n    setSelectedOption(selectedOption);\n  };\n\n  const imagePreview = e => {\n    setLogoPreview(URL.createObjectURL(e.target.files[0]));\n    setLogo(e.target.files[0]);\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"container\",\n    children:\n    /*#__PURE__*/\n\n    /*isResResData === true && logoPreview && */\n    _jsxDEV(\"form\", {\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"row pb-5\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"centralize mt-4 col-12 col-lg-6\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"input-block\",\n            children: [/*#__PURE__*/_jsxDEV(\"input\", {\n              className: \"input-org-form\",\n              type: \"text\",\n              id: \"name\",\n              spellCheck: \"false\",\n              ...register(\"name\", {\n                required: \"Name required\"\n              })\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 139,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"placeholder\",\n              children: \"Name 2\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 148,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 138,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 137,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"form-group m-auto\",\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            className: \"ml-4 logo-file d-inline\",\n            htmlFor: \"logoOrg\",\n            children: logoPreview && /*#__PURE__*/_jsxDEV(\"img\", {\n              src: urlImageAdapter(logoPreview),\n              alt: \"avatar\",\n              width: \"6%\",\n              className: \"avatar\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 154,\n              columnNumber: 19\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 152,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"file\",\n            className: \"form-control-file ml-4 shadow-none logo-file d-none\",\n            id: \"logoOrg\",\n            name: \"logoOrg\",\n            onChange: imagePreview,\n            multiple: false\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 162,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 151,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"col-12 col-lg-6 centralize mt-4\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"input-block\",\n            children: [/*#__PURE__*/_jsxDEV(\"input\", {\n              className: \"input-org-form\",\n              type: \"text\",\n              id: \"organization_size\",\n              spellCheck: \"false\",\n              ...register(\"organization_size\")\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 173,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"placeholder\",\n              children: \"Organization Size\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 180,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 172,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 171,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"col-12 col-lg-6 centralize mt-4\",\n          children: /*#__PURE__*/_jsxDEV(Select, {\n            placeholder: \"Select Organization type\",\n            value: selectedOption,\n            onChange: handleChange,\n            options: options\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 184,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 183,\n          columnNumber: 13\n        }, this), \" \", /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"col-12 col-lg-6 centralize mt-4\",\n          children: /*#__PURE__*/_jsxDEV(Select, {\n            placeholder: \"Select the Country office\",\n            value: selectedOption,\n            onChange: handleChange,\n            options: options\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 192,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 191,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"col-12 mt-4\",\n          children: /*#__PURE__*/_jsxDEV(JoditEditor, {\n            ref: editor,\n            value: content,\n            config: config,\n            tabIndex: 1,\n            onBlur: newContent => setContent(newContent)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 200,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 199,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: handleSubmit(onSubmit),\n          type: \"submit\",\n          className: \"btn btn-primary w-100 h-25 submit-login my-5 \",\n          children: idSubOrganization !== undefined ? \"Save Modifications\" : \"Add Local organizations office\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 208,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 136,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 135,\n      columnNumber: 54\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 133,\n    columnNumber: 5\n  }, this);\n};\n\n_s(AddOrganizationForm, \"ZgPpOHr5+q0d6AGFYWaA76Z7+ms=\", false, function () {\n  return [useHistory, useParams, useForm];\n});\n\n_c = AddOrganizationForm;\nexport default AddOrganizationForm;\n\nvar _c;\n\n$RefreshReg$(_c, \"AddOrganizationForm\");","map":{"version":3,"sources":["/Users/yasmine/Desktop/stage/aidchannel-front/src/components/aidchannel/superadmin/OrganizationForm.js"],"names":["React","useState","useRef","useEffect","useCallback","useHistory","useParams","useForm","JoditEditor","Select","getCountryByCode","AddOrganization","getAllHeadOrganizationsWithIdAndName","getOrganization","updateOrganization","fakeLogo","urlImageAdapter","AddOrganizationForm","history","codeCountry","idSubOrganization","editor","content","setContent","options","setOptions","selectedOption","setSelectedOption","suborganization","setSubOrganization","isResResData","setIsResData","logoPreview","setLogoPreview","logo","setLogo","config","readonly","placeholder","register","handleSubmit","setValue","getDataFromApi","organizations","map","org","value","_id","label","name","undefined","subOrg","head_office_id","description","organization_size","youtube_url","twitter_username","onSubmit","data","country","headOffice","formData","FormData","append","JSON","stringify","organization_types","substring","console","log","push","handleChange","imagePreview","e","URL","createObjectURL","target","files","required","newContent"],"mappings":";;;AAAA,OAAOA,KAAP,IAAgBC,QAAhB,EAA0BC,MAA1B,EAAkCC,SAAlC,EAA6CC,WAA7C,QAAgE,OAAhE;AACA,SAASC,UAAT,EAAqBC,SAArB,QAAsC,kBAAtC;AACA,SAASC,OAAT,QAAwB,iBAAxB;AACA,OAAOC,WAAP,MAAwB,aAAxB;AACA,OAAOC,MAAP,MAAmB,cAAnB;AACA,SAASC,gBAAT,QAAiC,0BAAjC;AACA,SACEC,eADF,EAEEC,oCAFF,EAGEC,eAHF,EAIEC,kBAJF,QAKO,+BALP;AAMA,OAAO,mCAAP;AACA,OAAOC,QAAP,MAAqB,qCAArB;AACA,OAAOC,eAAP,MAA4B,yBAA5B;;;AAEA,MAAMC,mBAAmB,GAAG,MAAM;AAAA;;AAChC,QAAMC,OAAO,GAAGb,UAAU,EAA1B;AACA,QAAM;AAAEc,IAAAA,WAAF;AAAeC,IAAAA;AAAf,MAAqCd,SAAS,EAApD;AACA,QAAMe,MAAM,GAAGnB,MAAM,CAAC,IAAD,CAArB;AACA,QAAM,CAACoB,OAAD,EAAUC,UAAV,IAAwBtB,QAAQ,CAAC,EAAD,CAAtC;AACA,QAAM,CAACuB,OAAD,EAAUC,UAAV,IAAwBxB,QAAQ,EAAtC;AACA,QAAM,CAACyB,cAAD,EAAiBC,iBAAjB,IAAsC1B,QAAQ,CAAC,IAAD,CAApD;AACA,QAAM,CAAC2B,eAAD,EAAkBC,kBAAlB,IAAwC5B,QAAQ,EAAtD;AACA,QAAM,CAAC6B,YAAD,EAAeC,YAAf,IAA+B9B,QAAQ,CAAC,KAAD,CAA7C;AACA,QAAM,CAAC+B,WAAD,EAAcC,cAAd,IAAgChC,QAAQ,CAAC,IAAD,CAA9C;AACA,QAAM,CAACiC,IAAD,EAAOC,OAAP,IAAkBlC,QAAQ,EAAhC;AAEA,QAAMmC,MAAM,GAAG;AACbC,IAAAA,QAAQ,EAAE,KADG;AAEbC,IAAAA,WAAW,EAAE;AAFA,GAAf;AAKA,QAAM;AACJC,IAAAA,QADI;AAEJC,IAAAA,YAFI;AAGJC,IAAAA,QAHI,CAIJ;;AAJI,MAKFlC,OAAO,EALX;AAOA,QAAMmC,cAAc,GAAGtC,WAAW,CAAC,YAAY;AAC7C,UAAMuC,aAAa,GAAG,MAAM/B,oCAAoC,EAAhE;AACAa,IAAAA,UAAU,CACRkB,aADQ,aACRA,aADQ,uBACRA,aAAa,CAAEC,GAAf,CAAoBC,GAAD,IAAS;AAC1B,aAAO;AACLC,QAAAA,KAAK,EAAED,GAAG,CAACE,GADN;AAELC,QAAAA,KAAK,EAAEH,GAAG,CAACI;AAFN,OAAP;AAID,KALD,CADQ,CAAV;;AAQA,QAAI7B,iBAAiB,KAAK8B,SAA1B,EAAqC;AAAA;;AACnC,YAAMC,MAAM,GAAG,MAAMtC,eAAe,CAACO,iBAAD,CAApC;AACAS,MAAAA,kBAAkB,CAACsB,MAAD,CAAlB;AACAlB,MAAAA,cAAc,CAACL,eAAD,aAACA,eAAD,uBAACA,eAAe,CAAEM,IAAlB,CAAd;AAEAP,MAAAA,iBAAiB,CAAC;AAChBmB,QAAAA,KAAK,EAAEK,MAAF,aAAEA,MAAF,gDAAEA,MAAM,CAAEC,cAAV,0DAAE,sBAAwBL,GADf;AAEhBC,QAAAA,KAAK,EAAEG,MAAF,aAAEA,MAAF,iDAAEA,MAAM,CAAEC,cAAV,2DAAE,uBAAwBH;AAFf,OAAD,CAAjB;AAKA1B,MAAAA,UAAU,CAAC4B,MAAD,aAACA,MAAD,uBAACA,MAAM,CAAEE,WAAT,CAAV;AACAZ,MAAAA,QAAQ,CAAC,MAAD,EAASU,MAAT,aAASA,MAAT,uBAASA,MAAM,CAAEF,IAAjB,CAAR;AACAR,MAAAA,QAAQ,CAAC,mBAAD,EAAsBU,MAAtB,aAAsBA,MAAtB,uBAAsBA,MAAM,CAAEG,iBAA9B,CAAR;AACAb,MAAAA,QAAQ,CAAC,aAAD,EAAgBU,MAAhB,aAAgBA,MAAhB,uBAAgBA,MAAM,CAAEI,WAAxB,CAAR;;AAEA,UAAIJ,MAAM,CAACK,gBAAX,EAA6B;AAC3Bf,QAAAA,QAAQ,CACN,kBADM,EAEL,uBAAsBU,MAAvB,aAAuBA,MAAvB,uBAAuBA,MAAM,CAAEK,gBAAiB,EAF1C,CAAR;AAID;AACF,KArBD,MAqBO;AACLvB,MAAAA,cAAc,CAAClB,QAAD,CAAd;AACD;;AACDgB,IAAAA,YAAY,CAAC,IAAD,CAAZ;AACD,GAnCiC,EAmC/B,CAACX,iBAAD,EAAoBqB,QAApB,EAA8BX,YAA9B,CAnC+B,CAAlC;AAqCA3B,EAAAA,SAAS,CAAC,MAAM;AACduC,IAAAA,cAAc;AACf,GAFQ,EAEN,CAACA,cAAD,CAFM,CAAT;;AAIA,QAAMe,QAAQ,GAAG,MAAOC,IAAP,IAAgB;AAAA;;AAC/B,UAAMC,OAAO,GAAG,MAAMjD,gBAAgB,CAACS,WAAD,CAAtC;AACA,UAAMyC,UAAU,GAAG,MAAM/C,eAAe,CAACa,cAAD,aAACA,cAAD,uBAACA,cAAc,CAAEoB,KAAjB,CAAxC;AAEA,QAAIe,QAAQ,GAAG,IAAIC,QAAJ,EAAf;AAEAD,IAAAA,QAAQ,CAACE,MAAT,CAAgB,gBAAhB,EAAkCH,UAAlC,aAAkCA,UAAlC,uBAAkCA,UAAU,CAAEb,GAA9C;AAEAc,IAAAA,QAAQ,CAACE,MAAT,CACE,oBADF,EAEEC,IAAI,CAACC,SAAL,CAAeL,UAAf,aAAeA,UAAf,uBAAeA,UAAU,CAAEM,kBAA3B,CAFF;AAKA,QAAIR,IAAI,CAACF,gBAAL,KAA0B,EAA9B,EAAkCK,QAAQ,CAACE,MAAT,CAAgB,kBAAhB,EAAoC,IAApC,EAAlC,KAEEF,QAAQ,CAACE,MAAT,CACE,kBADF,EAEEL,IAFF,aAEEA,IAFF,gDAEEA,IAAI,CAAEF,gBAFR,0DAEE,sBAAwBW,SAAxB,CAAkC,EAAlC,CAFF;AAKF,QAAIT,IAAI,CAACH,WAAL,KAAqB,EAAzB,EAA6BM,QAAQ,CAACE,MAAT,CAAgB,aAAhB,EAA+B,IAA/B,EAA7B,KACKF,QAAQ,CAACE,MAAT,CAAgB,aAAhB,EAA+BL,IAAI,CAACH,WAApC;AACL,QAAIG,IAAI,CAACJ,iBAAL,KAA2B,EAA/B,EACEO,QAAQ,CAACE,MAAT,CAAgB,mBAAhB,EAAqC,IAArC,EADF,KAEKF,QAAQ,CAACE,MAAT,CAAgB,mBAAhB,EAAqCL,IAAI,CAACJ,iBAA1C;AACL,QAAIhC,OAAO,KAAK,EAAhB,EAAoBuC,QAAQ,CAACE,MAAT,CAAgB,aAAhB,EAA+B,IAA/B,EAApB,KACKF,QAAQ,CAACE,MAAT,CAAgB,aAAhB,EAA+BzC,OAA/B;AACL,QAAIY,IAAI,IAAIgB,SAAZ,EAAuBW,QAAQ,CAACE,MAAT,CAAgB,SAAhB,EAA2B7B,IAA3B;AAEvB2B,IAAAA,QAAQ,CAACE,MAAT,CAAgB,MAAhB,EAAwBL,IAAI,CAACT,IAA7B;AACAY,IAAAA,QAAQ,CAACE,MAAT,CAAgB,SAAhB,EAA2BJ,OAAO,CAACZ,GAAnC;AACAqB,IAAAA,OAAO,CAACC,GAAR,CAAYR,QAAZ;;AACA,QAAIzC,iBAAiB,KAAK8B,SAA1B,EAAqC;AACnC,YAAMpC,kBAAkB,CAACM,iBAAD,EAAoByC,QAApB,CAAxB;AACD,KAFD,MAEO;AACL,YAAMlD,eAAe,CAACkD,QAAD,CAArB;AACD;;AAED3C,IAAAA,OAAO,CAACoD,IAAR,CAAc,6BAA4BnD,WAAY,EAAtD;AACD,GAvCD;;AAyCA,QAAMoD,YAAY,GAAI7C,cAAD,IAAoB;AACvCC,IAAAA,iBAAiB,CAACD,cAAD,CAAjB;AACD,GAFD;;AAIA,QAAM8C,YAAY,GAAIC,CAAD,IAAO;AAC1BxC,IAAAA,cAAc,CAACyC,GAAG,CAACC,eAAJ,CAAoBF,CAAC,CAACG,MAAF,CAASC,KAAT,CAAe,CAAf,CAApB,CAAD,CAAd;AACA1C,IAAAA,OAAO,CAACsC,CAAC,CAACG,MAAF,CAASC,KAAT,CAAe,CAAf,CAAD,CAAP;AACD,GAHD;;AAKA,sBACE;AAAK,IAAA,SAAS,EAAC,WAAf;AAAA;AAAA;;AAEI;AAA6C;AAAA,6BAC3C;AAAK,QAAA,SAAS,EAAC,UAAf;AAAA,gCACE;AAAK,UAAA,SAAS,EAAC,iCAAf;AAAA,iCACE;AAAK,YAAA,SAAS,EAAC,aAAf;AAAA,oCACE;AACE,cAAA,SAAS,EAAC,gBADZ;AAEE,cAAA,IAAI,EAAC,MAFP;AAGE,cAAA,EAAE,EAAC,MAHL;AAIE,cAAA,UAAU,EAAC,OAJb;AAAA,iBAKMtC,QAAQ,CAAC,MAAD,EAAS;AACnBuC,gBAAAA,QAAQ,EAAE;AADS,eAAT;AALd;AAAA;AAAA;AAAA;AAAA,oBADF,eAUE;AAAM,cAAA,SAAS,EAAC,aAAhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBAVF;AAAA;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,gBADF,eAeE;AAAK,UAAA,SAAS,EAAC,mBAAf;AAAA,kCACE;AAAO,YAAA,SAAS,EAAC,yBAAjB;AAA2C,YAAA,OAAO,EAAC,SAAnD;AAAA,sBACG9C,WAAW,iBACV;AACE,cAAA,GAAG,EAAEhB,eAAe,CAACgB,WAAD,CADtB;AAEE,cAAA,GAAG,EAAC,QAFN;AAGE,cAAA,KAAK,EAAC,IAHR;AAIE,cAAA,SAAS,EAAC;AAJZ;AAAA;AAAA;AAAA;AAAA;AAFJ;AAAA;AAAA;AAAA;AAAA,kBADF,eAWE;AACE,YAAA,IAAI,EAAC,MADP;AAEE,YAAA,SAAS,EAAC,qDAFZ;AAGE,YAAA,EAAE,EAAC,SAHL;AAIE,YAAA,IAAI,EAAC,SAJP;AAKE,YAAA,QAAQ,EAAEwC,YALZ;AAME,YAAA,QAAQ,EAAE;AANZ;AAAA;AAAA;AAAA;AAAA,kBAXF;AAAA;AAAA;AAAA;AAAA;AAAA,gBAfF,eAmCE;AAAK,UAAA,SAAS,EAAC,iCAAf;AAAA,iCACE;AAAK,YAAA,SAAS,EAAC,aAAf;AAAA,oCACE;AACE,cAAA,SAAS,EAAC,gBADZ;AAEE,cAAA,IAAI,EAAC,MAFP;AAGE,cAAA,EAAE,EAAC,mBAHL;AAIE,cAAA,UAAU,EAAC,OAJb;AAAA,iBAKMjC,QAAQ,CAAC,mBAAD;AALd;AAAA;AAAA;AAAA;AAAA,oBADF,eAQE;AAAM,cAAA,SAAS,EAAC,aAAhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBARF;AAAA;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,gBAnCF,eA+CE;AAAK,UAAA,SAAS,EAAC,iCAAf;AAAA,iCACE,QAAC,MAAD;AACE,YAAA,WAAW,EAAC,0BADd;AAEE,YAAA,KAAK,EAAEb,cAFT;AAGE,YAAA,QAAQ,EAAE6C,YAHZ;AAIE,YAAA,OAAO,EAAE/C;AAJX;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,gBA/CF,EAsDS,GAtDT,eAuDE;AAAK,UAAA,SAAS,EAAC,iCAAf;AAAA,iCACE,QAAC,MAAD;AACE,YAAA,WAAW,EAAC,2BADd;AAEE,YAAA,KAAK,EAAEE,cAFT;AAGE,YAAA,QAAQ,EAAE6C,YAHZ;AAIE,YAAA,OAAO,EAAE/C;AAJX;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,gBAvDF,eA+DE;AAAK,UAAA,SAAS,EAAC,aAAf;AAAA,iCACE,QAAC,WAAD;AACE,YAAA,GAAG,EAAEH,MADP;AAEE,YAAA,KAAK,EAAEC,OAFT;AAGE,YAAA,MAAM,EAAEc,MAHV;AAIE,YAAA,QAAQ,EAAE,CAJZ;AAKE,YAAA,MAAM,EAAG2C,UAAD,IAAgBxD,UAAU,CAACwD,UAAD;AALpC;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,gBA/DF,eAwEE;AACE,UAAA,OAAO,EAAEvC,YAAY,CAACiB,QAAD,CADvB;AAEE,UAAA,IAAI,EAAC,QAFP;AAGE,UAAA,SAAS,EAAC,+CAHZ;AAAA,oBAKGrC,iBAAiB,KAAK8B,SAAtB,GACG,oBADH,GAEG;AAPN;AAAA;AAAA;AAAA;AAAA,gBAxEF;AAAA;AAAA;AAAA;AAAA;AAAA;AAD2C;AAAA;AAAA;AAAA;AAAA;AAFjD;AAAA;AAAA;AAAA;AAAA,UADF;AA0FD,CA7MD;;GAAMjC,mB;UACYZ,U,EAC2BC,S,EAoBvCC,O;;;KAtBAU,mB;AA+MN,eAAeA,mBAAf","sourcesContent":["import React, { useState, useRef, useEffect, useCallback } from \"react\";\nimport { useHistory, useParams } from \"react-router-dom\";\nimport { useForm } from \"react-hook-form\";\nimport JoditEditor from \"jodit-react\";\nimport Select from \"react-select\";\nimport { getCountryByCode } from \"../../../apis/countryApi\";\nimport {\n  AddOrganization,\n  getAllHeadOrganizationsWithIdAndName,\n  getOrganization,\n  updateOrganization,\n} from \"../../../apis/organizationApi\";\nimport \"../webmaster/OrganizationForm.css\";\nimport fakeLogo from \"../../../assets/images/fakeLogo.png\";\nimport urlImageAdapter from \"helpers/urlImageAdapter\";\n\nconst AddOrganizationForm = () => {\n  const history = useHistory();\n  const { codeCountry, idSubOrganization } = useParams();\n  const editor = useRef(null);\n  const [content, setContent] = useState(\"\");\n  const [options, setOptions] = useState();\n  const [selectedOption, setSelectedOption] = useState(null);\n  const [suborganization, setSubOrganization] = useState();\n  const [isResResData, setIsResData] = useState(false);\n  const [logoPreview, setLogoPreview] = useState(null);\n  const [logo, setLogo] = useState();\n\n  const config = {\n    readonly: false,\n    placeholder: \"Write Organization description\",\n  };\n\n  const {\n    register,\n    handleSubmit,\n    setValue,\n    //formState: { errors },\n  } = useForm();\n\n  const getDataFromApi = useCallback(async () => {\n    const organizations = await getAllHeadOrganizationsWithIdAndName();\n    setOptions(\n      organizations?.map((org) => {\n        return {\n          value: org._id,\n          label: org.name,\n        };\n      })\n    );\n    if (idSubOrganization !== undefined) {\n      const subOrg = await getOrganization(idSubOrganization);\n      setSubOrganization(subOrg);\n      setLogoPreview(suborganization?.logo);\n\n      setSelectedOption({\n        value: subOrg?.head_office_id?._id,\n        label: subOrg?.head_office_id?.name,\n      });\n\n      setContent(subOrg?.description);\n      setValue(\"name\", subOrg?.name);\n      setValue(\"organization_size\", subOrg?.organization_size);\n      setValue(\"youtube_url\", subOrg?.youtube_url);\n\n      if (subOrg.twitter_username) {\n        setValue(\n          \"twitter_username\",\n          `https://twitter.com/${subOrg?.twitter_username}`\n        );\n      }\n    } else {\n      setLogoPreview(fakeLogo);\n    }\n    setIsResData(true);\n  }, [idSubOrganization, setValue, isResResData]);\n\n  useEffect(() => {\n    getDataFromApi();\n  }, [getDataFromApi]);\n\n  const onSubmit = async (data) => {\n    const country = await getCountryByCode(codeCountry);\n    const headOffice = await getOrganization(selectedOption?.value);\n\n    let formData = new FormData();\n\n    formData.append(\"head_office_id\", headOffice?._id);\n\n    formData.append(\n      \"organization_types\",\n      JSON.stringify(headOffice?.organization_types)\n    );\n\n    if (data.twitter_username === \"\") formData.append(\"twitter_username\", null);\n    else\n      formData.append(\n        \"twitter_username\",\n        data?.twitter_username?.substring(20)\n      );\n\n    if (data.youtube_url === \"\") formData.append(\"youtube_url\", null);\n    else formData.append(\"youtube_url\", data.youtube_url);\n    if (data.organization_size === \"\")\n      formData.append(\"organization_size\", null);\n    else formData.append(\"organization_size\", data.organization_size);\n    if (content === \"\") formData.append(\"description\", null);\n    else formData.append(\"description\", content);\n    if (logo != undefined) formData.append(\"logoOrg\", logo);\n\n    formData.append(\"name\", data.name);\n    formData.append(\"country\", country._id);\n    console.log(formData);\n    if (idSubOrganization !== undefined) {\n      await updateOrganization(idSubOrganization, formData);\n    } else {\n      await AddOrganization(formData);\n    }\n\n    history.push(`/web-master/organizations/${codeCountry}`);\n  };\n\n  const handleChange = (selectedOption) => {\n    setSelectedOption(selectedOption);\n  };\n\n  const imagePreview = (e) => {\n    setLogoPreview(URL.createObjectURL(e.target.files[0]));\n    setLogo(e.target.files[0]);\n  };\n\n  return (\n    <div className=\"container\">\n      {\n        /*isResResData === true && logoPreview && */ <form>\n          <div className=\"row pb-5\">\n            <div className=\"centralize mt-4 col-12 col-lg-6\">\n              <div className=\"input-block\">\n                <input\n                  className=\"input-org-form\"\n                  type=\"text\"\n                  id=\"name\"\n                  spellCheck=\"false\"\n                  {...register(\"name\", {\n                    required: \"Name required\",\n                  })}\n                />\n                <span className=\"placeholder\">Name 2</span>\n              </div>\n            </div>\n            <div className=\"form-group m-auto\">\n              <label className=\"ml-4 logo-file d-inline\" htmlFor=\"logoOrg\">\n                {logoPreview && (\n                  <img\n                    src={urlImageAdapter(logoPreview)}\n                    alt=\"avatar\"\n                    width=\"6%\"\n                    className=\"avatar\"\n                  />\n                )}\n              </label>\n              <input\n                type=\"file\"\n                className=\"form-control-file ml-4 shadow-none logo-file d-none\"\n                id=\"logoOrg\"\n                name=\"logoOrg\"\n                onChange={imagePreview}\n                multiple={false}\n              />\n            </div>\n            <div className=\"col-12 col-lg-6 centralize mt-4\">\n              <div className=\"input-block\">\n                <input\n                  className=\"input-org-form\"\n                  type=\"text\"\n                  id=\"organization_size\"\n                  spellCheck=\"false\"\n                  {...register(\"organization_size\")}\n                />\n                <span className=\"placeholder\">Organization Size</span>\n              </div>\n            </div>\n            <div className=\"col-12 col-lg-6 centralize mt-4\">\n              <Select\n                placeholder=\"Select Organization type\"\n                value={selectedOption}\n                onChange={handleChange}\n                options={options}\n              />\n            </div>{\" \"}\n            <div className=\"col-12 col-lg-6 centralize mt-4\">\n              <Select\n                placeholder=\"Select the Country office\"\n                value={selectedOption}\n                onChange={handleChange}\n                options={options}\n              />\n            </div>\n            <div className=\"col-12 mt-4\">\n              <JoditEditor\n                ref={editor}\n                value={content}\n                config={config}\n                tabIndex={1}\n                onBlur={(newContent) => setContent(newContent)}\n              />\n            </div>\n            <button\n              onClick={handleSubmit(onSubmit)}\n              type=\"submit\"\n              className=\"btn btn-primary w-100 h-25 submit-login my-5 \"\n            >\n              {idSubOrganization !== undefined\n                ? \"Save Modifications\"\n                : \"Add Local organizations office\"}\n            </button>\n          </div>\n        </form>\n      }\n    </div>\n  );\n};\n\nexport default AddOrganizationForm;\n"]},"metadata":{},"sourceType":"module"}